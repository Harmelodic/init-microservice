name: pull-request

on:
  pull_request:
    branches:
      - main
  workflow_dispatch: {}

jobs:
  maven:
    uses: Harmelodic/github-workflows/.github/workflows/verify-java-project.yaml@main

  terraform:
    permissions:
      contents: 'read'
      id-token: 'write'
    uses: Harmelodic/github-workflows/.github/workflows/validate-terraform-gcp.yaml@main
    with:
      terraform_directory: infrastructure
      workload_identity_provider: projects/401363556022/locations/global/workloadIdentityPools/automation/providers/github
      service_account: automation@automation-220928.iam.gserviceaccount.com
